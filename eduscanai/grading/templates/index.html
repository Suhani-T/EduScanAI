{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduScanAI</title>
    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji" rel="stylesheet">

    <meta name="csrf-token" content="{{ csrf_token }}">
    <style>
        :root {
            --primary-color:#7c25ff;  
            --secondary-color:#5b17fa; 
            --text-color:white; 
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar {
            height: 50px;
            padding: 5px 20px; 
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-brand img {
            height: 35px; 
            width: auto;
        }

        .navbar-nav .nav-link {
            font-size: 16px;
            padding: 8px 12px; 
        }

        .navbar-toggler {
            padding: 5px 8px;
            border: none;
        }

        @media screen and (max-width: 768px) {
            .navbar {
                height: auto; 
            }

            .navbar-nav {
                text-align: center;
            }

            .navbar-collapse {
                background: rgba(0, 0, 0, 0.9); 
                padding: 10px 0;
            }

            .nav-item {
                padding: 8px 0;
            }
        }
        

        .hero {
            background: url("{% static 'images/hero_background.png' %}") no-repeat center center/cover;
            height: 55vh;
            display: flex;
            align-items: center;
            justify-content: left;
        }

        .overlay {
            background: rgba(0, 0, 0, 0.6);
            padding: 30px;
            border-radius: 20px;
            text-align: left;
            color: var(--text-color);
            width: 100%;
            max-width: 500px;
            margin: 20px;
            margin-left:55px;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        p {
            font-size: 16px;
            margin-bottom: 20px;
        }

        .try{
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            color: var(--text-color);
            background: var(--primary-color);
            box-shadow: 0px 0px 5px 2px rgb(57, 57, 57);
            transition: transform 0.2s ease;
        }

        .try:hover{
            transform: scale(1.1);
            background:var(--secondary-color);
        }

        

        .content {
            margin: 40px;
        }

        .evaluate{
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            color: var(--text-color);
            background: var(--secondary-color);
            transition: transform 0.2s ease;
        }
        .evaluate:hover{
            transform: scale(1.1);
            background:var(--primary-color);
            color: var(--text-color);
        }

        .sendotpbtn{
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            color: var(--text-color);
            background: black;
            transition: transform 0.2s ease;
        }
        .sendotpbtn:hover{
            transform: scale(1.1);
            background:black;
            color: var(--text-color);
        }

        .verifyotpbtn{
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            color: var(--text-color);
            background: var(--secondary-color);
            transition: transform 0.2s ease;
        }
        .verifyotpbtn:hover{
            transform: scale(1.1);
            background:var(--primary-color);
            color: var(--text-color);
        }

        .close:hover{
            transform: scale(1.1);
        }
       

       

        .headings {
            font-size: 36px;
            font-weight: bold;
        }

        #usage img {
            width: 97%;
            margin:19px;

        }

        .steps-container {
            display: flex;
            justify-content: center;
            align-items: stretch;
            gap: 20px;
            margin: 40px 10px;
        }

        .step-card {
            border: none;
            padding: 20px;
            width: 250px;
        }

        .step-number {
            font-size: 32px;
            font-weight: bold;
            color: #650de6;
            text-align: left;
        }

        .step-image {
            width: 100%;
            height: auto;
            margin-bottom: 15px;
            border-radius:8px;
        }


        .step-content {
            text-align: left;
        }

        .step-title {
            font-size: 18px;
            font-weight: bold;
            color: #5b17fa;
            margin-bottom: 5px;
        }


        .step-description {
            font-size: 14px;
            color: #555;
        }

        .inputs{
            max-width: 600px;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            margin-top: 50px;
        }

        .form-label {
            font-weight: bold;
            color:var(--secondary-color);
        }

        .review img{
            border-color:2px solid #5b17fa;
            display:flex;
            align-items:center;
            justify-content:center;
            margin-left:8rem;
            max-width:400px;
        }

        .footer {
            background: black;
            color: var(--text-color);
            padding: 20px 0;
            text-align: center;
            margin-top: 40px;
        }

        .footer a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .notranslate {
            unicode-bidi: isolate; 
        }
        .dropdown-menu {
            max-height: 300px;
            overflow-y: auto;
        }

        .dropdown-item {
            font-family: 'Noto Color Emoji', sans-serif;
        }

        .btn-gradient-danger {
            position: relative;
            overflow: hidden;
            background-color: transparent;
            border: 2px solid var(--secondary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: color 0.3s ease, border 0.3s ease;
            z-index: 1;
        }

        .btn-gradient-danger::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff004c, var(--secondary-color));
            transition: all 0.4s ease;
            z-index: -1;
        }

        .btn-gradient-danger:hover::before {
            left: 0;
        }

        .btn-gradient-danger:hover {
        color: var(--text-color);
        border: 2px solid black;
        }





    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-black px-5">
        <a class="navbar-brand" href="#"><img src="{% static 'images/EduScan_logo.png' %}" height="45px" width="200px"></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            <ul class="navbar-nav">
                <!-- <li class="nav-item"><a class="nav-link" href="#">Home</a></li> -->
                <!-- <li class="nav-item"><a class="nav-link" href="#">About</a></li> -->
                
                <li class="nav-item"><a class="nav-link" href="#" onclick="scrollToSection('about-section')">About</a></li>
                

                <li class="nav-item dropdown notranslate">
                    <a class="nav-link dropdown-toggle" href="#" id="languageDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        ğŸŒ <span id="selected-language">English</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="languageDropdown">
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('English'); translatePage('en');">
                            ğŸ‡¬ğŸ‡§ English
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('franÃ§ais'); translatePage('fr');">
                            ğŸ‡«ğŸ‡· franÃ§ais (French)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('espaÃ±ol'); translatePage('es');">
                            ğŸ‡ªğŸ‡¸ espaÃ±ol (Spanish)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('à¤¹à¤¿à¤¨à¥à¤¦à¥€'); translatePage('hi');">
                            ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€ (Hindi)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Deutsch'); translatePage('de');">
                            ğŸ‡©ğŸ‡ª Deutsch (German)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('ä¸­æ–‡'); translatePage('zh-CN');">
                            ğŸ‡¨ğŸ‡³ ä¸­æ–‡ (Chinese Simplified)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Ğ ÑƒÑÑĞºĞ¸Ğ¹'); translatePage('ru');">
                            ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ (Russian)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('PortuguÃªs'); translatePage('pt');">
                            ğŸ‡µğŸ‡¹ PortuguÃªs (Portuguese)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('æ—¥æœ¬èª'); translatePage('ja');">
                            ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª (Japanese)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('í•œêµ­ì–´'); translatePage('ko');">
                            ğŸ‡°ğŸ‡· í•œêµ­ì–´ (Korean)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Italiano'); translatePage('it');">
                            ğŸ‡®ğŸ‡¹ Italiano (Italian)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('TÃ¼rkÃ§e'); translatePage('tr');">
                            ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e (Turkish)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'); translatePage('ar');">
                            ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Arabic)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('à¦¬à¦¾à¦‚à¦²à¦¾'); translatePage('bn');">
                            ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾ (Bengali)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Tiáº¿ng Viá»‡t'); translatePage('vi');">
                            ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t (Vietnamese)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Polski'); translatePage('pl');">
                            ğŸ‡µğŸ‡± Polski (Polish)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Nederlands'); translatePage('nl');">
                            ğŸ‡³ğŸ‡± Nederlands (Dutch)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°'); translatePage('uk');">
                            ğŸ‡ºğŸ‡¦ Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ° (Ukrainian)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('×¢×‘×¨×™×ª'); translatePage('he');">
                            ğŸ‡®ğŸ‡± ×¢×‘×¨×™×ª (Hebrew)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('à¹„à¸—à¸¢'); translatePage('th');">
                            ğŸ‡¹ğŸ‡­ à¹„à¸—à¸¢ (Thai)
                        </a></li>
                        <li><a class="dropdown-item notranslate" href="#" onclick="setLanguage('Swahili'); translatePage('sw');">
                            ğŸ‡°ğŸ‡ªğŸ‡¹ğŸ‡¿ğŸ‡ºğŸ‡¬ Swahili
                        </a></li>
                    </ul> 
                </li>

                <button class="btn btn-gradient-danger" style="border-radius: 8px;" id="authenticateButton">Authenticate</button>
                

            </ul>
        </div>
    </nav>

    <div class="hero">
        <div class="overlay">
            <h1>AI-Powered Teaching Assistant <br> for Faster Grading</h1>
            <p>Automated grading, personalized feedback, and save <br> valuable teaching time.</p>
            <div class="buttons">
                <button class="try" onclick="scrollToSection('steps-to-use')">Try it out âœ </button>

            </div>
        </div>
    </div>

    <div class="container content">
        <h2 class="headings">Our Vision</h2>
        <p>
            In modern education, teachers are burdened with large classroom sizes, extensive grading responsibilities, and the challenge of providing meaningful feedback to students. 
            Manual grading is not only time-consuming but also limits a teacherâ€™s ability to deliver personalized guidance. 
            Our AI-Powered Teaching Assistant is designed to revolutionize the grading process by automating evaluation, generating personalized feedback, and reducing the workload of educators.
        </p>
    </div>

    <div class="container content">
        <h2 id="steps-to-use"class="headings">How to Use</h2>
    </div> 

    <div class="container">
        <div class="steps-container">
            <div class="card step-card h-100">
                <div class="step-number">01</div>
                <img src="{% static 'images/step1.png' %}" alt="Step 1" class="step-image">
                <div class="step-content">
                    <div class="step-title">PROVIDE ANSWER KEY</div>
                    <div class="step-description">Upload correct answers and marking scheme</div>
                </div>
            </div>
    
            <div class="card step-card h-100">
                <div class="step-number">02</div>
                <img src="{% static 'images/step2.png' %}" alt="Step 2" class="step-image">
                <div class="step-content">
                    <div class="step-title">UPLOAD ANSWER SCRIPT</div>
                    <div class="step-description">Scan and upload student answer sheets</div>
                </div>
            </div>
    
            <div class="card step-card h-100">
                <div class="step-number">03</div>
                <img src="{% static 'images/step3.png' %}" alt="Step 3" class="step-image">
                <div class="step-content">
                    <div class="step-title">AI EVALUATION & FEEDBACK</div>
                    <div class="step-description">AI auto-grades, highlights mistakes, and generates personalized feedback</div>
                </div>
            </div>
    
            <div class="card step-card h-100">
                <div class="step-number">04</div>
                <img src="{% static 'images/step4.png' %}" alt="Step 4" class="step-image">
                <div class="step-content">
                    <div class="step-title">REVIEW & SEND FEEDBACK</div>
                    <div class="step-description">Modify AI feedback and email it to students</div>
                </div>
            </div>
        </div>
    </div>
   <!-- otp sec -->

   <div class="modal" tabindex="-1" id="otpModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Enter OTP</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="POST" id="otp-form">
                {% csrf_token %}
            <div class="modal-body">
                <div class="mb-3">
                    <label for="emailInput" class="form-label">Enter your Email</label>
                    <input type="email" class="form-control" id="emailInput" placeholder="Teacher's Email" required>
                </div>
                <div class="mb-3">
                    <label for="otpInput" class="form-label">Enter OTP</label>
                    <input type="text" class="form-control" id="otpInput" placeholder="Enter OTP" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary close"  data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn sendotpbtn"  id="sendOtpButton">Send OTP</button>
                <button type="button" class="btn verifyotpbtn" id="verifyOtpButton">Verify OTP</button>
            </div>
            </form>
        </div>
    </div>
</div>
<!-- evaluation sec -->

    <div class="container content">
        <h2 class="headings">Evaluate Answer Script</h2>
    </div>    
    
    <div class="container content d-flex align-items-start gap-5"> 
        <div class="w-50">
            <form id="evaluationForm">
                <div class="mb-3">
                    <label for="teacherEmail" class="form-label fw-bold">Teacher's Email</label>
                    <input type="email" id="teacherEmail" name="teacher_email" class="form-control" disabled>
                    <!-- <input type="email" class="form-control" id="teacherEmail" placeholder="Enter teacher's email" required> -->
                </div>
    


                <div class="mb-3">
                    <label for="answerKey" class="form-label fw-bold">Answer Key Document</label>
                    <input type="file" class="form-control" id="answerKey" accept=".txt" required>
                    <small class="text-muted">Upload text document</small>
                </div>
    
                <div class="student-input-box p-3 border rounded position-relative">
                    <button type="button" class="btn btn-outline-secondary position-absolute top-0 end-0 m-2" id="resetButton">Reset</button>
    
                    <div class="mb-3">
                        <label for="studentEmail" class="form-label fw-bold">Student's Email</label>
                        <input type="email" class="form-control" id="studentEmail" placeholder="Enter student's email" required>
                    </div>
    

                    <div class="mb-3">
                        <label for="studentScript" class="form-label fw-bold">Student's Answer Script</label>
                        <input type="file" class="form-control" id="studentScript" accept=".pdf,.jpg,.png" required>
                        <small class="text-muted">Please scan and upload document</small>
                    </div>
                </div>
                <br>
    

                <div>
                    <!-- <button class="evaluate btn btn-primary" type="button" id="evaluateButton">Evaluate</button> -->
                    <button type="submit" class="btn evaluate" id="evaluateButton" disabled>Evaluate</button>
                </div>
            </form>
        </div>
    
        <div class="review ml-auto">
            <img src="{% static 'images/review_logo.png' %}" class="img-fluid" alt="Review Logo">
        </div>
    </div>


    <div class="container content mt-5">
        <h2 class="mb-4 headings">Generated Feedback</h2>
    
        <form id="feedbackForm">
            <div class="mb-3">
                <label for="feedbackText" class="form-label fw-bold">Generated Feedback</label>
                <textarea id="feedbackText" class="form-control" rows="5" placeholder="Generated feedback will appear here..." required></textarea>
            </div>
    
            <button class="evaluate btn " type="button" id="sendFeedbackButton">Send Feedback</button>
            <p id="message" class="mt-3 text-success fw-bold"></p>
        </form>
    </div>
    
    
    
    <div id="about-section" class="container content mt-5">
        <h2 class="mb-4 headings">About EduScanAI</h2>
        <p>
        EduScanAI is an AI-powered teaching assistant designed to automate grading, provide personalized feedback, and enhance the learning experience. Our platform converts handwritten answers into text, evaluates them using advanced AI models, and generates meaningful feedback to help both students and educators.
        </p>
        <div>
        <p>
        Key Features:<br>
        â˜‘ï¸ Handwriting-to-Text Conversion â€“ Accurately extracts handwritten responses.<br>
        â˜‘ï¸ AI-Powered Evaluation â€“ Compares answers with expected solutions and assigns scores.<br>
        â˜‘ï¸ Instant Feedback â€“ Provides constructive insights to improve student performance.<br>
        â˜‘ï¸ Time-Saving Automation â€“ Reduces the burden of manual grading for educators.<br>
        </p>
        </div>

        <p>
        We believe in leveraging AI to make education smarter, more efficient, and accessible for all!
        </p>
        
        <h2 class="mb-4 headings">Meet the Team: SUAN</h2>
        <p>
        SUAN represents two enthusiastic women in tech, driven by the passion to bridge the gap between AI and education.
        </p>

        <div>
        <p>
        ğŸ‘©â€ğŸ’» Smart â€“ Always innovating and finding smarter ways to improve learning.<br>
        ğŸ‘©â€ğŸ’» United â€“ Strong teamwork and collaboration define our approach.<br>
        ğŸ‘©â€ğŸ’» Ambitious â€“ We aim high, constantly pushing boundaries in AI and tech.<br>
        ğŸ‘©â€ğŸ’» Nurturing â€“ We foster a community of learning, growth, and inclusivity.<br>
        </p>
        </div>

        <p>
        As young tech enthusiasts, we are dedicated to building AI solutions that truly make a difference. EduScanAI is just the beginning of our journey to revolutionize education with technology! 
        </p>
    </div>
    

    <footer class="footer">
        <p>Â© 2025 EduScanAI. All Rights Reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    
<script>
    document.addEventListener("DOMContentLoaded", function () {
        
        let isAuthenticated = false;
        let teacherEmail = '';


        function updateAuthUI() {
            const authButton = document.getElementById('authenticateButton');
            const teacherEmailInput = document.getElementById('teacherEmail');
            const evaluateButton = document.getElementById('evaluateButton');
            
            if (isAuthenticated) {
                authButton.textContent = 'Logout';
                authButton.classList.remove('evaluate');
                authButton.classList.add('btn-gradient-danger');
                teacherEmailInput.value = teacherEmail;
                evaluateButton.disabled = false; 
            } else {
                authButton.textContent = 'Authenticate';
                authButton.classList.remove('btn-gradient-danger');
                authButton.classList.add('evaluate');
                teacherEmailInput.value = '';
                evaluateButton.disabled = true; 
                resetAllForms(); 
            }
        }

        
        function resetAllForms() {
           
            document.getElementById("studentEmail").value = "";
            document.getElementById("answerKey").value = "";
            document.getElementById("studentScript").value = "";
            
           
            document.getElementById("feedbackText").value = "";
            document.getElementById("message").innerText = "";
            
          
            document.getElementById("emailInput").value = "";
            document.getElementById("otpInput").value = "";
            document.getElementById("emailInput").disabled = false;
        }

        
        if (sessionStorage.getItem('isAuthenticated') === 'true') {
            isAuthenticated = true;
            teacherEmail = sessionStorage.getItem('teacherEmail') || '';
            updateAuthUI();
        }

        
        function scrollToSection(sectionId) {
            let section = document.getElementById(sectionId);
            let offset = 70; 
            let sectionPosition = section.getBoundingClientRect().top + window.scrollY - offset;
            window.scrollTo({ top: sectionPosition, behavior: "smooth" });
        }

        
        const authenticateButton = document.getElementById('authenticateButton');
        authenticateButton.addEventListener('click', function() {
            if (isAuthenticated) {
                
                isAuthenticated = false;
                teacherEmail = '';
                sessionStorage.removeItem('isAuthenticated');
                sessionStorage.removeItem('teacherEmail');
                updateAuthUI();
            } else {
               
                const otpModal = new bootstrap.Modal(document.getElementById('otpModal'));
                otpModal.show();
            }
        });

        
        const sendOtpButton = document.getElementById("sendOtpButton");
        const verifyOtpButton = document.getElementById("verifyOtpButton");
        const emailInput = document.getElementById("emailInput");
        const otpInput = document.getElementById("otpInput");

        sendOtpButton.addEventListener('click', function () {
            const email = emailInput.value;
            if (!email) {
                alert('Please enter your email.');
                return;
            }

           
            const csrfToken = document.querySelector('[name=csrf-token]').content; 

            
            fetch("/send-otp/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    'X-CSRFToken': csrfToken
                },
                body: `email=${encodeURIComponent(email)}`,
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
                if (data.status === "success") {
                    
                    emailInput.disabled = true;
                }
            })
            .catch(error => {
                alert("There was an error sending the OTP.");
                console.error(error);
            });
        });

        verifyOtpButton.addEventListener("click", function () {
            const email = emailInput.value;
            const otp = otpInput.value;
            if (!otp) {
                alert("Please enter the OTP.");
                return;
            }

            
            fetch("/verify-otp/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    'X-CSRFToken': document.querySelector('[name=csrf-token]').content
                },
                body: `email=${encodeURIComponent(email)}&otp=${encodeURIComponent(otp)}`,
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === "success") {
                    
                    isAuthenticated = true;
                    teacherEmail = email;
                    sessionStorage.setItem('isAuthenticated', 'true');
                    sessionStorage.setItem('teacherEmail', email);
                    updateAuthUI();
                    
                    
                    const otpModal = bootstrap.Modal.getInstance(document.getElementById('otpModal'));
                    otpModal.hide();
                    emailInput.disabled = false;
                    emailInput.value = '';
                    otpInput.value = '';
                    
                    alert("OTP verified successfully!");
                } else {
                    alert(data.message || "Invalid OTP.");
                }
            })
            .catch(error => {
                console.error("Error:", error);
                alert("There was an error verifying the OTP.");
            });
        });

        
        const evaluationForm = document.getElementById('evaluationForm');
        evaluationForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!isAuthenticated) {
                alert("Please authenticate first!");
                return;
            }

            const teacherEmail = document.getElementById("teacherEmail").value;
            const studentEmail = document.getElementById("studentEmail").value;
            const answerKey = document.getElementById("answerKey").files[0];
            const studentScript = document.getElementById("studentScript").files[0];

            if (!teacherEmail || !studentEmail || !answerKey || !studentScript) {
                alert("Please fill all fields and upload the required files.");
                return;
            }

            let formData = new FormData();
            formData.append("teacher_email", teacherEmail);
            formData.append("student_email", studentEmail);
            formData.append("answer_key", answerKey);
            formData.append("student_script", studentScript);

            document.getElementById("evaluateButton").disabled = true;

            fetch("/evaluate/", {
                method: "POST",
                body: formData,
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Failed to evaluate script.");
                }
                return response.json();
            })
            .then(data => {
                document.getElementById("feedbackText").value = data.feedback;
            })
            .catch(error => {
                console.error("Error:", error);
                alert("Error generating feedback.");
            })
            .finally(() => {
                document.getElementById("evaluateButton").disabled = false;
            });
        });

        
        document.getElementById("sendFeedbackButton").addEventListener("click", function () {
            const teacherEmail = document.getElementById("teacherEmail").value;
            const studentEmail = document.getElementById("studentEmail").value;
            const feedback = document.getElementById("feedbackText").value;

            if (!feedback.trim()) {
                alert("Feedback cannot be empty.");
                document.getElementById("feedbackText").style.border = "2px solid red";
                return;
            }

            document.getElementById("sendFeedbackButton").disabled = true;
            document.getElementById("feedbackText").style.border = "";

            fetch("/send-feedback/", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 
                    teacher_email: teacherEmail, 
                    student_email: studentEmail, 
                    feedback: feedback 
                }),
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Failed to send feedback.");
                }
                return response.json();
            })
            .then(data => {
                document.getElementById("message").innerText = `Results sent to ${studentEmail}`;
            })
            .catch(error => {
                console.error("Error:", error);
                alert("Error sending feedback.");
            })
            .finally(() => {
                document.getElementById("sendFeedbackButton").disabled = false;
            });
        });

        
        document.getElementById("resetButton").addEventListener("click", function () {
            resetStudentInputs();
        });
    });
</script>

    <script>
        function resetStudentInputs() {
            document.getElementById("studentEmail").value = "";
            document.getElementById("studentScript").value = "";
        }

        function setLanguage(lang) {
            document.getElementById("selected-language").textContent = lang;
        }
    </script>

    <!-- <script src="{% static 'js/evaluation.js' %}"></script> -->
     
    <script src="{% static 'js/translation.js' %}"></script>





    
</body>
</html>
